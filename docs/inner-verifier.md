<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /docs/mdsource/inner-verifier.source.md
To change this file edit the source file and then run MarkdownSnippets.
-->

# InnerVerifier

`InnerVerifier` provides low level access to the verification engine. It is exposed publicly for allowing test frameworks to consume Verify, in a similar way to the bundled extensions for MsTest, nUnit and xUnit. It is not intended for top level consumption of people writing tests.


## Scoping

`InnerVerifier` is short-lived. An instance of `InnerVerifier` should be constructed and disposed per test method run.


## Required information

`InnerVerifier` requires the following information to run a snapshot test.


### Method and type

The `Type` and `MethodInfo` contribute the [File Name](/docs/naming.md).

Depending on test framework this is derived from static or injected state.


### The test file path.

The file path is contributes to the [File Name](/docs/naming.md) and is usually done with a `CallerFilePath`.

<!-- snippet: GetFilePath -->
<a id='snippet-getfilepath'></a>
```cs
string GetFilePath([CallerFilePath] string sourceFile = "")
{
    return sourceFile;
}
```
<sup><a href='/src/Verify.Tests/Tests.cs#L772-L778' title='Snippet source file'>snippet source</a> | <a href='#snippet-getfilepath' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

This path would normally be passed in on each of the Verify method overloads. For example [the Verify file overload in Xunit](https://github.com/VerifyTests/Verify/blob/main/src/Verify.Xunit/Verifier_File.cs).


### VerifySettings

An instance of `VerifySettings` for configuring the verification behavior. It is also used to pass through any parameters used by the test.


## Examples

<!-- snippet: RawUsage -->
<a id='snippet-rawusage'></a>
```cs
[Fact]
public async Task RawUsage()
{
    var type = GetType();
    var method = type.GetMethod("RawUsage")!;
    var file = GetFilePath();
    var settings = new VerifySettings();
    
    GetFileConvention fileConvention = uniqueness => ReflectionFileNameBuilder.FileNamePrefix(method, type, file, settings, uniqueness);
    using var verifier = new InnerVerifier(file, settings, fileConvention);
    await verifier.Verify("Some value");
}
```
<sup><a href='/src/Verify.Tests/Tests.cs#L780-L794' title='Snippet source file'>snippet source</a> | <a href='#snippet-rawusage' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

<!-- snippet: RawUsageWithParams -->
<a id='snippet-rawusagewithparams'></a>
```cs
public async Task RawUsageWithParams(string param1, string param2)
{
    var type = GetType();
    var method = type.GetMethod("RawUsageWithParams")!;
    var file = GetFilePath();
    var settings = new VerifySettings();
    settings.UseParameters(param1, param2);
    GetFileConvention fileConvention = uniqueness => ReflectionFileNameBuilder.FileNamePrefix(method, type, file, settings, uniqueness);
    using var verifier = new InnerVerifier(file, settings, fileConvention);
    await verifier.Verify("Some value");
}
```
<sup><a href='/src/Verify.Tests/Tests.cs#L798-L810' title='Snippet source file'>snippet source</a> | <a href='#snippet-rawusagewithparams' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## Existing extensions

It can be helpful to review the existing extension to test frameworks.


### Xunit


#### Static approach

 * [InnerVerifier construction](https://github.com/VerifyTests/Verify/blob/main/src/Verify.Xunit/Verifier.cs)
 * [Example verify overload: File](https://github.com/VerifyTests/Verify/blob/main/src/Verify.Xunit/Verifier_File.cs)


#### Base class approach

 * [InnerVerifier construction](https://github.com/VerifyTests/Verify/blob/main/src/Verify.Xunit/VerifyBase.cs)
 * [Example verify overload: File](https://github.com/VerifyTests/Verify/blob/main/src/Verify.Xunit/VerifyBase_File.cs)


### NUnit


#### Static approach

 * [InnerVerifier construction](https://github.com/VerifyTests/Verify/blob/main/src/Verify.NUnit/Verifier.cs)
 * [Example verify overload: File](https://github.com/VerifyTests/Verify/blob/main/src/Verify.NUnit/Verifier_File.cs)


#### Base class approach

 * [InnerVerifier construction](https://github.com/VerifyTests/Verify/blob/main/src/Verify.NUnit/VerifyBase.cs)
 * [Example verify overload: File](https://github.com/VerifyTests/Verify/blob/main/src/Verify.NUnit/VerifyBase_File.cs)


### MSTest

MSTest has no static approach since it does not expose a static test context.

#### Base class approach

 * [InnerVerifier construction](https://github.com/VerifyTests/Verify/blob/main/src/Verify.MSTest/VerifyBase.cs)
 * [Example verify overload: File](https://github.com/VerifyTests/Verify/blob/main/src/Verify.MSTest/VerifyBase_File.cs)
