<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /docs/mdsource/serializer-settings.source.md
To change this file edit the source file and then run MarkdownSnippets.
-->

# Serializer settings

Serialization settings can be customized at three levels:

 * Method: Will run the verification in the current test method.
 * Class: Will run for all verifications in all test methods for a test class.
 * Global: Will run for test methods on all tests.

<!-- toc -->
## Contents

  * [Default settings](#default-settings)
  * [Single quotes used](#single-quotes-used)
  * [QuoteName is false](#quotename-is-false)
  * [Empty collections are ignored](#empty-collections-are-ignored)
  * [Guids are scrubbed](#guids-are-scrubbed)
  * [Dates are scrubbed](#dates-are-scrubbed)
  * [Default Booleans are ignored](#default-booleans-are-ignored)
  * [Change defaults at the verification level](#change-defaults-at-the-verification-level)
  * [Changing settings globally](#changing-settings-globally)
  * [Scoped settings](#scoped-settings)
  * [Ignoring a type](#ignoring-a-type)
  * [Ignoring a instance](#ignoring-a-instance)
  * [Ignore member by expressions](#ignore-member-by-expressions)
  * [Ignore member by name](#ignore-member-by-name)
  * [Members that throw](#members-that-throw)<!-- endtoc -->


## Default settings

The default serialization settings are:

<!-- snippet: defaultSerialization -->
<a id='snippet-defaultserialization'/></a>
```cs
var settings = new JsonSerializerSettings
{
    Formatting = Formatting.Indented,
    ReferenceLoopHandling = ReferenceLoopHandling.Ignore,
    DefaultValueHandling = DefaultValueHandling.Ignore
};
```
<sup><a href='/src/Verify/Serialization/SerializationSettings.cs#L152-L161' title='File snippet `defaultserialization` was extracted from'>snippet source</a> | <a href='#snippet-defaultserialization' title='Navigate to start of snippet `defaultserialization`'>anchor</a></sup>
<!-- endsnippet -->


## Single quotes used

[JsonTextWriter.QuoteChar](https://www.newtonsoft.com/json/help/html/P_Newtonsoft_Json_JsonTextWriter_QuoteChar.htm) is set to single quotes `'`. The reason for this is that it makes approval files cleaner and easier to read and visualize/understand differences.


## QuoteName is false

[JsonTextWriter.QuoteName](https://www.newtonsoft.com/json/help/html/P_Newtonsoft_Json_JsonTextWriter_QuoteName.htm) is set to false. The reason for this is that it makes approval files cleaner and easier to read and visualize/understand differences.


## Empty collections are ignored

By default empty collections are ignored during verification.

To disable this behavior globally use:

<!-- snippet: DontIgnoreEmptyCollections -->
<a id='snippet-dontignoreemptycollections'/></a>
```cs
SharedVerifySettings.ModifySerialization(_ => _.DontIgnoreEmptyCollections());
```
<sup><a href='/src/Verify.Tests/Snippets/SerializationSettingsSnippets.cs#L10-L12' title='File snippet `dontignoreemptycollections` was extracted from'>snippet source</a> | <a href='#snippet-dontignoreemptycollections' title='Navigate to start of snippet `dontignoreemptycollections`'>anchor</a></sup>
<!-- endsnippet -->


## Guids are scrubbed

By default guids are sanitized during verification. This is done by finding each guid and taking a counter based that that specific guid. That counter is then used replace the guid values. This allows for repeatable tests when guid values are changing.

<!-- snippet: guid -->
<a id='snippet-guid'/></a>
```cs
var guid = Guid.NewGuid();
var target = new GuidTarget
{
    Guid = guid,
    GuidNullable = guid,
    GuidString = guid.ToString(),
    OtherGuid = Guid.NewGuid(),
};

await Verify(target);
```
<sup><a href='/src/Verify.Tests/Tests.cs#L286-L299' title='File snippet `guid` was extracted from'>snippet source</a> | <a href='#snippet-guid' title='Navigate to start of snippet `guid`'>anchor</a></sup>
<!-- endsnippet -->

Results in the following:

<!-- snippet: Tests.ShouldReUseGuid.verified.txt -->
<a id='snippet-Tests.ShouldReUseGuid.verified.txt'/></a>
```txt
{
  Guid: Guid_1,
  GuidNullable: Guid_1,
  GuidString: Guid_1,
  OtherGuid: Guid_2
}
```
<sup><a href='/src/Verify.Tests/Tests.ShouldReUseGuid.verified.txt#L1-L6' title='File snippet `Tests.ShouldReUseGuid.verified.txt` was extracted from'>snippet source</a> | <a href='#snippet-Tests.ShouldReUseGuid.verified.txt' title='Navigate to start of snippet `Tests.ShouldReUseGuid.verified.txt`'>anchor</a></sup>
<!-- endsnippet -->

To disable this behavior globally use:

<!-- snippet: DontScrubGuids -->
<a id='snippet-dontscrubguids'/></a>
```cs
SharedVerifySettings.ModifySerialization(_ => _.DontScrubGuids());
```
<sup><a href='/src/Verify.Tests/Snippets/SerializationSettingsSnippets.cs#L17-L19' title='File snippet `dontscrubguids` was extracted from'>snippet source</a> | <a href='#snippet-dontscrubguids' title='Navigate to start of snippet `dontscrubguids`'>anchor</a></sup>
<!-- endsnippet -->


## Dates are scrubbed

By default dates (`DateTime` and `DateTimeOffset`) are sanitized during verification. This is done by finding each date and taking a counter based that that specific date. That counter is then used replace the date values. This allows for repeatable tests when date values are changing.

<!-- snippet: Date -->
<a id='snippet-date'/></a>
```cs
var dateTime = DateTime.Now;
var dateTimeOffset = DateTimeOffset.Now;
var target = new DateTimeTarget
{
    DateTime = dateTime,
    DateTimeNullable = dateTime,
    DateTimeString = dateTime.ToString("F"),
    DateTimeOffset = dateTimeOffset,
    DateTimeOffsetNullable = dateTimeOffset,
    DateTimeOffsetString = dateTimeOffset.ToString("F"),
};

await Verify(target);
```
<sup><a href='/src/Verify.Tests/Tests.cs#L793-L809' title='File snippet `date` was extracted from'>snippet source</a> | <a href='#snippet-date' title='Navigate to start of snippet `date`'>anchor</a></sup>
<!-- endsnippet -->

Results in the following:

<!-- snippet: Tests.ShouldReUseDatetime.verified.txt -->
<a id='snippet-Tests.ShouldReUseDatetime.verified.txt'/></a>
```txt
{
  DateTime: DateTime_1,
  DateTimeNullable: DateTime_1,
  DateTimeOffset: DateTimeOffset_1,
  DateTimeOffsetNullable: DateTimeOffset_1,
  DateTimeString: DateTimeOffset_2,
  DateTimeOffsetString: DateTimeOffset_2
}
```
<sup><a href='/src/Verify.Tests/Tests.ShouldReUseDatetime.verified.txt#L1-L8' title='File snippet `Tests.ShouldReUseDatetime.verified.txt` was extracted from'>snippet source</a> | <a href='#snippet-Tests.ShouldReUseDatetime.verified.txt' title='Navigate to start of snippet `Tests.ShouldReUseDatetime.verified.txt`'>anchor</a></sup>
<!-- endsnippet -->

To disable this behavior globally use:

<!-- snippet: DontScrubDateTimes -->
<a id='snippet-dontscrubdatetimes'/></a>
```cs
SharedVerifySettings.ModifySerialization(_ => _.DontScrubDateTimes());
```
<sup><a href='/src/Verify.Tests/Snippets/SerializationSettingsSnippets.cs#L24-L26' title='File snippet `dontscrubdatetimes` was extracted from'>snippet source</a> | <a href='#snippet-dontscrubdatetimes' title='Navigate to start of snippet `dontscrubdatetimes`'>anchor</a></sup>
<!-- endsnippet -->


## Default Booleans are ignored

By default values of `bool` and `bool?` are ignored during verification. So properties that equate to 'false' will not be written,

To disable this behavior globally use:

<!-- snippet: DontIgnoreFalse -->
<a id='snippet-dontignorefalse'/></a>
```cs
SharedVerifySettings.ModifySerialization(_ => _.DontIgnoreFalse());
```
<sup><a href='/src/Verify.Tests/Snippets/SerializationSettingsSnippets.cs#L31-L33' title='File snippet `dontignorefalse` was extracted from'>snippet source</a> | <a href='#snippet-dontignorefalse' title='Navigate to start of snippet `dontignorefalse`'>anchor</a></sup>
<!-- endsnippet -->


## Change defaults at the verification level

`DateTime`, `DateTimeOffset`, `Guid`, `bool`, and empty collection behavior can also be controlled at the verification level: 

<!-- snippet: ChangeDefaultsPerVerification -->
<a id='snippet-changedefaultsperverification'/></a>
```cs
var settings = new VerifySettings();
settings.ModifySerialization(_ =>
{
    _.DontIgnoreEmptyCollections();
    _.DontScrubGuids();
    _.DontScrubDateTimes();
    _.DontIgnoreFalse();
});
await Verify(target, settings);
```
<sup><a href='/src/Verify.MSTest.Tests/VerifyObjectSamples.cs#L17-L28' title='File snippet `changedefaultsperverification` was extracted from'>snippet source</a> | <a href='#snippet-changedefaultsperverification' title='Navigate to start of snippet `changedefaultsperverification`'>anchor</a></sup>
<a id='snippet-changedefaultsperverification-1'/></a>
```cs
var settings = new VerifySettings();
settings.ModifySerialization(_ =>
{
    _.DontIgnoreEmptyCollections();
    _.DontScrubGuids();
    _.DontScrubDateTimes();
    _.DontIgnoreFalse();
});
await Verifier.Verify(target, settings);
```
<sup><a href='/src/Verify.NUnit.Tests/VerifyObjectSamples.cs#L16-L28' title='File snippet `changedefaultsperverification` was extracted from'>snippet source</a> | <a href='#snippet-changedefaultsperverification-1' title='Navigate to start of snippet `changedefaultsperverification`'>anchor</a></sup>
<!-- endsnippet -->


## Changing settings globally

To change the serialization settings for all verifications use `Global.ApplyExtraSettings()`:

<!-- snippet: ExtraSettings -->
<a id='snippet-extrasettings'/></a>
```cs
var settings = new VerifySettings();
settings.AddExtraSettings(_ =>
{
    _.DateFormatHandling = DateFormatHandling.MicrosoftDateFormat;
    _.TypeNameHandling = TypeNameHandling.All;
});
```
<sup><a href='/src/Verify.Tests/Snippets/Snippets.cs#L39-L48' title='File snippet `extrasettings` was extracted from'>snippet source</a> | <a href='#snippet-extrasettings' title='Navigate to start of snippet `extrasettings`'>anchor</a></sup>
<!-- endsnippet -->


## Scoped settings

<!-- snippet: ScopedSerializer -->
<a id='snippet-scopedserializer'/></a>
```cs
var person = new Person
{
    GivenNames = "John",
    FamilyName = "Smith",
    Dob = new DateTimeOffset(2000, 10, 1, 0, 0, 0, TimeSpan.Zero),
};
var settings = new VerifySettings();
settings.ModifySerialization(
    _ => _.DontScrubDateTimes());
settings.AddExtraSettings(
    _ => { _.DateFormatHandling = DateFormatHandling.MicrosoftDateFormat; });
```
<sup><a href='/src/Verify.Tests/Snippets/Snippets.cs#L53-L67' title='File snippet `scopedserializer` was extracted from'>snippet source</a> | <a href='#snippet-scopedserializer' title='Navigate to start of snippet `scopedserializer`'>anchor</a></sup>
<!-- endsnippet -->

Result:

<!-- snippet: Verify.Xunit.Tests/VerifyObjectSamples.ScopedSerializer.verified.txt -->
<a id='snippet-Verify.Xunit.Tests/VerifyObjectSamples.ScopedSerializer.verified.txt'/></a>
```txt
{
  GivenNames: 'John',
  FamilyName: 'Smith',
  Dob: '\/Date(970358400000+0000)\/'
}
```
<sup><a href='/src/Verify.Xunit.Tests/VerifyObjectSamples.ScopedSerializer.verified.txt#L1-L5' title='File snippet `Verify.Xunit.Tests/VerifyObjectSamples.ScopedSerializer.verified.txt` was extracted from'>snippet source</a> | <a href='#snippet-Verify.Xunit.Tests/VerifyObjectSamples.ScopedSerializer.verified.txt' title='Navigate to start of snippet `Verify.Xunit.Tests/VerifyObjectSamples.ScopedSerializer.verified.txt`'>anchor</a></sup>
<!-- endsnippet -->


## Ignoring a type

To ignore all members that match a certain type:

<!-- snippet: AddIgnoreType -->
<a id='snippet-addignoretype'/></a>
```cs
var settings = new VerifySettings();
settings.ModifySerialization(_ => _.IgnoreMembersWithType<ToIgnore>());

var target = new IgnoreTypeTarget
{
    ToIgnore = new ToIgnore
    {
        Property = "Value"
    },
    ToInclude = new ToInclude
    {
        Property = "Value"
    }
};
await Verify(target, settings);
```
<sup><a href='/src/Verify.Tests/Tests.cs#L389-L406' title='File snippet `addignoretype` was extracted from'>snippet source</a> | <a href='#snippet-addignoretype' title='Navigate to start of snippet `addignoretype`'>anchor</a></sup>
<!-- endsnippet -->

Result:

<!-- snippet: Tests.IgnoreType.verified.txt -->
<a id='snippet-Tests.IgnoreType.verified.txt'/></a>
```txt
{
  ToInclude: {
    Property: 'Value'
  }
}
```
<sup><a href='/src/Verify.Tests/Tests.IgnoreType.verified.txt#L1-L5' title='File snippet `Tests.IgnoreType.verified.txt` was extracted from'>snippet source</a> | <a href='#snippet-Tests.IgnoreType.verified.txt' title='Navigate to start of snippet `Tests.IgnoreType.verified.txt`'>anchor</a></sup>
<!-- endsnippet -->


## Ignoring a instance

To ignore instances of a type based on delegate:

<!-- snippet: AddIgnoreInstance -->
<a id='snippet-addignoreinstance'/></a>
```cs
var settings = new VerifySettings();
settings.ModifySerialization(
    _ => { _.IgnoreInstance<Instance>(x => x.Property == "Ignore"); });

var target = new IgnoreInstanceTarget
{
    ToIgnore = new Instance
    {
        Property = "Ignore"
    },
    ToInclude = new Instance
    {
        Property = "Include"
    }
};
await Verify(target, settings);
```
<sup><a href='/src/Verify.Tests/Tests.cs#L354-L372' title='File snippet `addignoreinstance` was extracted from'>snippet source</a> | <a href='#snippet-addignoreinstance' title='Navigate to start of snippet `addignoreinstance`'>anchor</a></sup>
<!-- endsnippet -->

Result:

<!-- snippet: Tests.AddIgnoreInstance.verified.txt -->
<a id='snippet-Tests.AddIgnoreInstance.verified.txt'/></a>
```txt
{
  ToInclude: {
    Property: 'Include'
  }
}
```
<sup><a href='/src/Verify.Tests/Tests.AddIgnoreInstance.verified.txt#L1-L5' title='File snippet `Tests.AddIgnoreInstance.verified.txt` was extracted from'>snippet source</a> | <a href='#snippet-Tests.AddIgnoreInstance.verified.txt' title='Navigate to start of snippet `Tests.AddIgnoreInstance.verified.txt`'>anchor</a></sup>
<!-- endsnippet -->


## Ignore member by expressions

To ignore members of a certain type using an expression:

<!-- snippet: IgnoreMemberByExpression -->
<a id='snippet-ignorememberbyexpression'/></a>
```cs
var settings = new VerifySettings();
settings.ModifySerialization(_ =>
{
    _.IgnoreMember<IgnoreExplicitTarget>(x => x.Property);
    _.IgnoreMember<IgnoreExplicitTarget>(x => x.Field);
    _.IgnoreMember<IgnoreExplicitTarget>(x => x.GetOnlyProperty);
    _.IgnoreMember<IgnoreExplicitTarget>(x => x.PropertyThatThrows);
});

var target = new IgnoreExplicitTarget
{
    Include = "Value",
    Field = "Value",
    Property = "Value"
};
await Verify(target, settings);
```
<sup><a href='/src/Verify.Tests/Tests.cs#L428-L446' title='File snippet `ignorememberbyexpression` was extracted from'>snippet source</a> | <a href='#snippet-ignorememberbyexpression' title='Navigate to start of snippet `ignorememberbyexpression`'>anchor</a></sup>
<!-- endsnippet -->

Result:

<!-- snippet: Tests.IgnoreMemberByExpression.verified.txt -->
<a id='snippet-Tests.IgnoreMemberByExpression.verified.txt'/></a>
```txt
{
  Include: 'Value'
}
```
<sup><a href='/src/Verify.Tests/Tests.IgnoreMemberByExpression.verified.txt#L1-L3' title='File snippet `Tests.IgnoreMemberByExpression.verified.txt` was extracted from'>snippet source</a> | <a href='#snippet-Tests.IgnoreMemberByExpression.verified.txt' title='Navigate to start of snippet `Tests.IgnoreMemberByExpression.verified.txt`'>anchor</a></sup>
<!-- endsnippet -->


## Ignore member by name

To ignore members of a certain type using type and name:

<!-- snippet: IgnoreMemberByName -->
<a id='snippet-ignorememberbyname'/></a>
```cs
var settings = new VerifySettings();
settings.ModifySerialization(_ =>
{
    var type = typeof(IgnoreExplicitTarget);
    _.IgnoreMember(type, "Property");
    _.IgnoreMember(type, "Field");
    _.IgnoreMember(type, "GetOnlyProperty");
    _.IgnoreMember(type, "PropertyThatThrows");
});

var target = new IgnoreExplicitTarget
{
    Include = "Value",
    Field = "Value",
    Property = "Value"
};
await Verify(target, settings);
```
<sup><a href='/src/Verify.Tests/Tests.cs#L452-L471' title='File snippet `ignorememberbyname` was extracted from'>snippet source</a> | <a href='#snippet-ignorememberbyname' title='Navigate to start of snippet `ignorememberbyname`'>anchor</a></sup>
<!-- endsnippet -->

Result:

<!-- snippet: Tests.IgnoreMemberByName.verified.txt -->
<a id='snippet-Tests.IgnoreMemberByName.verified.txt'/></a>
```txt
{
  Include: 'Value'
}
```
<sup><a href='/src/Verify.Tests/Tests.IgnoreMemberByName.verified.txt#L1-L3' title='File snippet `Tests.IgnoreMemberByName.verified.txt` was extracted from'>snippet source</a> | <a href='#snippet-Tests.IgnoreMemberByName.verified.txt' title='Navigate to start of snippet `Tests.IgnoreMemberByName.verified.txt`'>anchor</a></sup>
<!-- endsnippet -->


## Members that throw

Members that throw exceptions can be excluded from serialization based on the exception type or properties.

By default members that throw `NotImplementedException` or `NotSupportedException` are ignored.

Note that this is global for all members on all types.

Ignore by exception type:

<!-- snippet: IgnoreMembersThatThrow -->
<a id='snippet-ignoremembersthatthrow'/></a>
```cs
var settings = new VerifySettings();
settings.ModifySerialization(_ => _.IgnoreMembersThatThrow<CustomException>());

var target = new WithCustomException();
await Verify(target, settings);
```
<sup><a href='/src/Verify.Tests/Tests.cs#L498-L505' title='File snippet `ignoremembersthatthrow` was extracted from'>snippet source</a> | <a href='#snippet-ignoremembersthatthrow' title='Navigate to start of snippet `ignoremembersthatthrow`'>anchor</a></sup>
<!-- endsnippet -->

Result:

<!-- snippet: Tests.CustomExceptionProp.verified.txt -->
<a id='snippet-Tests.CustomExceptionProp.verified.txt'/></a>
```txt
{}
```
<sup><a href='/src/Verify.Tests/Tests.CustomExceptionProp.verified.txt#L1-L1' title='File snippet `Tests.CustomExceptionProp.verified.txt` was extracted from'>snippet source</a> | <a href='#snippet-Tests.CustomExceptionProp.verified.txt' title='Navigate to start of snippet `Tests.CustomExceptionProp.verified.txt`'>anchor</a></sup>
<!-- endsnippet -->

Ignore by exception type and expression:

<!-- snippet: IgnoreMembersThatThrowExpression -->
<a id='snippet-ignoremembersthatthrowexpression'/></a>
```cs
var settings = new VerifySettings();
settings.ModifySerialization(
    _ => _.IgnoreMembersThatThrow<Exception>(x => x.Message == "Ignore"));

var target = new WithExceptionIgnoreMessage();
await Verify(target, settings);
```
<sup><a href='/src/Verify.Tests/Tests.cs#L562-L570' title='File snippet `ignoremembersthatthrowexpression` was extracted from'>snippet source</a> | <a href='#snippet-ignoremembersthatthrowexpression' title='Navigate to start of snippet `ignoremembersthatthrowexpression`'>anchor</a></sup>
<!-- endsnippet -->

Result:

<!-- snippet: Tests.ExceptionMessageProp.verified.txt -->
<a id='snippet-Tests.ExceptionMessageProp.verified.txt'/></a>
```txt
{}
```
<sup><a href='/src/Verify.Tests/Tests.ExceptionMessageProp.verified.txt#L1-L1' title='File snippet `Tests.ExceptionMessageProp.verified.txt` was extracted from'>snippet source</a> | <a href='#snippet-Tests.ExceptionMessageProp.verified.txt' title='Navigate to start of snippet `Tests.ExceptionMessageProp.verified.txt`'>anchor</a></sup>
<!-- endsnippet -->
