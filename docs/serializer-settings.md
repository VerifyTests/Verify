<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /docs/mdsource/serializer-settings.source.md
To change this file edit the source file and then run MarkdownSnippets.
-->

# Serializer settings

Serialization settings can be customized at three levels:

 * Method: Will run the verification in the current test method.
 * Class: Will run for all verifications in all test methods for a test class.
 * Global: Will run for test methods on all tests.

<!-- toc -->
## Contents

  * [Not valid json](#not-valid-json)
  * [Default settings](#default-settings)
  * [QuoteName is false](#quotename-is-false)
  * [Empty collections are ignored](#empty-collections-are-ignored)
  * [Guids are scrubbed](#guids-are-scrubbed)
  * [Dates are scrubbed](#dates-are-scrubbed)
  * [Default Booleans are ignored](#default-booleans-are-ignored)
  * [Change defaults at the verification level](#change-defaults-at-the-verification-level)
  * [Changing Json.NET settings](#changing-jsonnet-settings)
    * [Globally](#globally)
    * [Instance](#instance)
    * [Json.NET Converter](#jsonnet-converter)
  * [Scoped settings](#scoped-settings)
  * [Ignoring a type](#ignoring-a-type)
  * [Ignoring a instance](#ignoring-a-instance)
  * [Obsolete members ignored](#obsolete-members-ignored)
    * [Including Obsolete members](#including-obsolete-members)
  * [Ignore member by expressions](#ignore-member-by-expressions)
  * [Ignore member by name](#ignore-member-by-name)
  * [Members that throw](#members-that-throw)
  * [TreatAsString](#treatasstring)<!-- endToc -->


## Not valid json

Note that the output is technically not valid json.

 * Names and values are not quoted.
 * Newlines are not escaped.

The reason for these is that it makes approval files cleaner and easier to read and visualize/understand differences.


## Default settings

The default serialization settings are:

<!-- snippet: defaultSerialization -->
<a id='snippet-defaultserialization'></a>
```cs
JsonSerializerSettings settings = new()
{
    Formatting = Formatting.Indented,
    ReferenceLoopHandling = ReferenceLoopHandling.Ignore,
    DefaultValueHandling = DefaultValueHandling.Ignore
};
```
<sup><a href='/src/Verify/Serialization/SerializationSettings.cs#L205-L214' title='Snippet source file'>snippet source</a> | <a href='#snippet-defaultserialization' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## QuoteName is false

[JsonTextWriter.QuoteName](https://www.newtonsoft.com/json/help/html/P_Newtonsoft_Json_JsonTextWriter_QuoteName.htm) is set to false. The reason for this is that it makes approval files cleaner and easier to read and visualize/understand differences.


## Empty collections are ignored

By default empty collections are ignored during verification.

To disable this behavior globally use:

<!-- snippet: DontIgnoreEmptyCollections -->
<a id='snippet-dontignoreemptycollections'></a>
```cs
VerifierSettings.ModifySerialization(_ => _.DontIgnoreEmptyCollections());
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.cs#L262-L266' title='Snippet source file'>snippet source</a> | <a href='#snippet-dontignoreemptycollections' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## Guids are scrubbed

By default guids are sanitized during verification. This is done by finding each guid and taking a counter based that that specific guid. That counter is then used replace the guid values. This allows for repeatable tests when guid values are changing.

<!-- snippet: guid -->
<a id='snippet-guid'></a>
```cs
var guid = Guid.NewGuid();
GuidTarget target = new()
{
    Guid = guid,
    GuidNullable = guid,
    GuidString = guid.ToString(),
    OtherGuid = Guid.NewGuid(),
};

await Verifier.Verify(target);
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.cs#L459-L472' title='Snippet source file'>snippet source</a> | <a href='#snippet-guid' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

Results in the following:

<!-- snippet: SerializationTests.ShouldReUseGuid.verified.txt -->
<a id='snippet-SerializationTests.ShouldReUseGuid.verified.txt'></a>
```txt
{
  Guid: Guid_1,
  GuidNullable: Guid_1,
  GuidString: Guid_1,
  OtherGuid: Guid_2
}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.ShouldReUseGuid.verified.txt#L1-L6' title='Snippet source file'>snippet source</a> | <a href='#snippet-SerializationTests.ShouldReUseGuid.verified.txt' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

To disable this behavior globally use:

<!-- snippet: DontScrubGuids -->
<a id='snippet-dontscrubguids'></a>
```cs
VerifierSettings.ModifySerialization(_ => _.DontScrubGuids());
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.cs#L271-L275' title='Snippet source file'>snippet source</a> | <a href='#snippet-dontscrubguids' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

Strings containing inline Guids can also be scrubbed. To enable this behavior, use:

<!-- snippet: ScrubInlineGuids -->
<a id='snippet-scrubinlineguids'></a>
```cs
VerifierSettings.ScrubInlineGuids();
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.cs#L280-L284' title='Snippet source file'>snippet source</a> | <a href='#snippet-scrubinlineguids' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## Dates are scrubbed

By default dates (`DateTime` and `DateTimeOffset`) are sanitized during verification. This is done by finding each date and taking a counter based that that specific date. That counter is then used replace the date values. This allows for repeatable tests when date values are changing.

<!-- snippet: Date -->
<a id='snippet-date'></a>
```cs
var dateTime = DateTime.Now;
var dateTimeOffset = DateTimeOffset.Now;
DateTimeTarget target = new()
{
    DateTime = dateTime,
    DateTimeNullable = dateTime,
    DateTimeString = dateTime.ToString("F"),
    DateTimeOffset = dateTimeOffset,
    DateTimeOffsetNullable = dateTimeOffset,
    DateTimeOffsetString = dateTimeOffset.ToString("F"),
};

await Verifier.Verify(target);
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.cs#L29-L45' title='Snippet source file'>snippet source</a> | <a href='#snippet-date' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

Results in the following:

<!-- snippet: SerializationTests.ShouldReUseDatetime.verified.txt -->
<a id='snippet-SerializationTests.ShouldReUseDatetime.verified.txt'></a>
```txt
{
  DateTime: DateTime_1,
  DateTimeNullable: DateTime_1,
  DateTimeOffset: DateTimeOffset_1,
  DateTimeOffsetNullable: DateTimeOffset_1,
  DateTimeString: DateTimeOffset_2,
  DateTimeOffsetString: DateTimeOffset_2
}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.ShouldReUseDatetime.verified.txt#L1-L8' title='Snippet source file'>snippet source</a> | <a href='#snippet-SerializationTests.ShouldReUseDatetime.verified.txt' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

To disable this behavior globally use:

<!-- snippet: DontScrubDateTimes -->
<a id='snippet-dontscrubdatetimes'></a>
```cs
VerifierSettings.ModifySerialization(_ => _.DontScrubDateTimes());
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.cs#L289-L293' title='Snippet source file'>snippet source</a> | <a href='#snippet-dontscrubdatetimes' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## Default Booleans are ignored

By default values of `bool` and `bool?` are ignored during verification. So properties that equate to 'false' will not be written,

To disable this behavior globally use:

<!-- snippet: DontIgnoreFalse -->
<a id='snippet-dontignorefalse'></a>
```cs
VerifierSettings.ModifySerialization(_ => _.DontIgnoreFalse());
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.cs#L298-L302' title='Snippet source file'>snippet source</a> | <a href='#snippet-dontignorefalse' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## Change defaults at the verification level

`DateTime`, `DateTimeOffset`, `Guid`, `bool`, and empty collection behavior can also be controlled at the verification level: 

<!-- snippet: ChangeDefaultsPerVerification -->
<a id='snippet-changedefaultsperverification'></a>
```cs
VerifySettings settings = new();

settings.ModifySerialization(_ =>
{
    _.DontIgnoreEmptyCollections();
    _.DontScrubGuids();
    _.DontScrubDateTimes();
    _.DontIgnoreFalse();
});
await Verify(target, settings);
```
<sup><a href='/src/Verify.MSTest.Tests/VerifyObjectSamples.cs#L17-L30' title='Snippet source file'>snippet source</a> | <a href='#snippet-changedefaultsperverification' title='Start of snippet'>anchor</a></sup>
<a id='snippet-changedefaultsperverification-1'></a>
```cs
await Verify(target)
    .ModifySerialization(_ =>
    {
        _.DontIgnoreEmptyCollections();
        _.DontScrubGuids();
        _.DontScrubDateTimes();
        _.DontIgnoreFalse();
    });
```
<sup><a href='/src/Verify.MSTest.Tests/VerifyObjectSamples.cs#L32-L43' title='Snippet source file'>snippet source</a> | <a href='#snippet-changedefaultsperverification-1' title='Start of snippet'>anchor</a></sup>
<a id='snippet-changedefaultsperverification-2'></a>
```cs
await Verifier.Verify(target)
    .ModifySerialization(_ =>
    {
        _.DontIgnoreEmptyCollections();
        _.DontScrubGuids();
        _.DontScrubDateTimes();
        _.DontIgnoreFalse();
    });
```
<sup><a href='/src/Verify.NUnit.Tests/VerifyObjectSamples.cs#L16-L27' title='Snippet source file'>snippet source</a> | <a href='#snippet-changedefaultsperverification-2' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## Changing Json.NET settings

Extra Json.NET settings can be made:


### Globally

<!-- snippet: ExtraSettingsGlobal -->
<a id='snippet-extrasettingsglobal'></a>
```cs
VerifierSettings.AddExtraSettings(_ =>
{
    _.DateFormatHandling = DateFormatHandling.MicrosoftDateFormat;
    _.TypeNameHandling = TypeNameHandling.All;
});
```
<sup><a href='/src/Verify.Tests/Snippets/Snippets.cs#L137-L145' title='Snippet source file'>snippet source</a> | <a href='#snippet-extrasettingsglobal' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


### Instance

<!-- snippet: ExtraSettingsInstance -->
<a id='snippet-extrasettingsinstance'></a>
```cs
VerifySettings settings = new();
settings.AddExtraSettings(_ =>
{
    _.DateFormatHandling = DateFormatHandling.MicrosoftDateFormat;
    _.TypeNameHandling = TypeNameHandling.All;
});
```
<sup><a href='/src/Verify.Tests/Snippets/Snippets.cs#L147-L156' title='Snippet source file'>snippet source</a> | <a href='#snippet-extrasettingsinstance' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


### Json.NET Converter

One common use case is to register a custom [JsonConverter](https://www.newtonsoft.com/json/help/html/CustomJsonConverter.htm). As only writing is required, to help with this there is `WriteOnlyJsonConverter`, and `WriteOnlyJsonConverter<T>`.

<!-- snippet: CompanyConverter -->
<a id='snippet-companyconverter'></a>
```cs
class CompanyConverter :
    WriteOnlyJsonConverter<Company>
{
    public override void WriteJson(
        JsonWriter writer,
        Company? company,
        JsonSerializer serializer,
        IReadOnlyDictionary<string, object> context)
    {
        if (company != null)
        {
            serializer.Serialize(writer, company.Name);
        }
    }
}
```
<sup><a href='/src/Verify.Tests/Snippets/Snippets.cs#L168-L186' title='Snippet source file'>snippet source</a> | <a href='#snippet-companyconverter' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

<!-- snippet: JsonConverter -->
<a id='snippet-jsonconverter'></a>
```cs
VerifierSettings.AddExtraSettings(_ => { _.Converters.Add(new CompanyConverter()); });
```
<sup><a href='/src/Verify.Tests/Snippets/Snippets.cs#L161-L165' title='Snippet source file'>snippet source</a> | <a href='#snippet-jsonconverter' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## Scoped settings

<!-- snippet: ScopedSerializer -->
<a id='snippet-scopedserializer'></a>
```cs
[Fact]
public Task ScopedSerializer()
{
    Person person = new()
    {
        GivenNames = "John",
        FamilyName = "Smith"
    };
    VerifySettings settings = new();
    settings.AddExtraSettings(
        _ => { _.TypeNameHandling = TypeNameHandling.All; });
    return Verifier.Verify(person, settings);
}

[Fact]
public Task ScopedSerializerFluent()
{
    Person person = new()
    {
        GivenNames = "John",
        FamilyName = "Smith"
    };
    return Verifier.Verify(person)
        .AddExtraSettings(
            _ => { _.TypeNameHandling = TypeNameHandling.All; });
}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.cs#L1191-L1220' title='Snippet source file'>snippet source</a> | <a href='#snippet-scopedserializer' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

Result:

<!-- snippet: Verify.Xunit.Tests/VerifyObjectSamples.ScopedSerializer.verified.txt -->
<a id='snippet-Verify.Xunit.Tests/VerifyObjectSamples.ScopedSerializer.verified.txt'></a>
```txt
{
  $type: VerifyObjectSamples.Person,
  GivenNames: John,
  FamilyName: Smith
}
```
<sup><a href='/src/Verify.Xunit.Tests/VerifyObjectSamples.ScopedSerializer.verified.txt#L1-L5' title='Snippet source file'>snippet source</a> | <a href='#snippet-Verify.Xunit.Tests/VerifyObjectSamples.ScopedSerializer.verified.txt' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## Ignoring a type

To ignore all members that match a certain type:

<!-- snippet: AddIgnoreType -->
<a id='snippet-addignoretype'></a>
```cs
[Fact]
public async Task IgnoreType()
{
    IgnoreTypeTarget target = new()
    {
        ToIgnore = new()
        {
            Property = "Value"
        },
        ToInclude = new()
        {
            Property = "Value"
        }
    };
    VerifySettings settings = new();
    settings.ModifySerialization(_ => _.IgnoreMembersWithType<ToIgnore>());
    await Verifier.Verify(target, settings);
}

[Fact]
public async Task IgnoreTypeFluent()
{
    IgnoreTypeTarget target = new()
    {
        ToIgnore = new()
        {
            Property = "Value"
        },
        ToInclude = new()
        {
            Property = "Value"
        }
    };
    await Verifier.Verify(target)
        .ModifySerialization(_ => _.IgnoreMembersWithType<ToIgnore>());

}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.cs#L733-L773' title='Snippet source file'>snippet source</a> | <a href='#snippet-addignoretype' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

Result:

<!-- snippet: SerializationTests.IgnoreType.verified.txt -->
<a id='snippet-SerializationTests.IgnoreType.verified.txt'></a>
```txt
{
  ToInclude: {
    Property: Value
  }
}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.IgnoreType.verified.txt#L1-L5' title='Snippet source file'>snippet source</a> | <a href='#snippet-SerializationTests.IgnoreType.verified.txt' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## Ignoring a instance

To ignore instances of a type based on delegate:

<!-- snippet: AddIgnoreInstance -->
<a id='snippet-addignoreinstance'></a>
```cs
[Fact]
public async Task AddIgnoreInstance()
{
    IgnoreInstanceTarget target = new()
    {
        ToIgnore = new()
        {
            Property = "Ignore"
        },
        ToInclude = new()
        {
            Property = "Include"
        }
    };
    VerifySettings settings = new();
    settings.ModifySerialization(
        _ => { _.IgnoreInstance<Instance>(x => x.Property == "Ignore"); });
    await Verifier.Verify(target, settings);
}

[Fact]
public async Task AddIgnoreInstanceFluent()
{
    IgnoreInstanceTarget target = new()
    {
        ToIgnore = new()
        {
            Property = "Ignore"
        },
        ToInclude = new()
        {
            Property = "Include"
        }
    };
    await Verifier.Verify(target)
        .ModifySerialization(
            _ => { _.IgnoreInstance<Instance>(x => x.Property == "Ignore"); });
}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.cs#L679-L720' title='Snippet source file'>snippet source</a> | <a href='#snippet-addignoreinstance' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

Result:

<!-- snippet: SerializationTests.AddIgnoreInstance.verified.txt -->
<a id='snippet-SerializationTests.AddIgnoreInstance.verified.txt'></a>
```txt
{
  ToInclude: {
    Property: Include
  }
}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.AddIgnoreInstance.verified.txt#L1-L5' title='Snippet source file'>snippet source</a> | <a href='#snippet-SerializationTests.AddIgnoreInstance.verified.txt' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## Obsolete members ignored

Members with an [ObsoleteAttribute](https://docs.microsoft.com/en-us/dotnet/api/system.obsoleteattribute) are ignored:

<!-- snippet: WithObsoleteProp -->
<a id='snippet-withobsoleteprop'></a>
```cs
class WithObsolete
{
    [Obsolete] public string ObsoleteProperty { get; set; }
    public string OtherProperty { get; set; }
}

[Fact]
public Task WithObsoleteProp()
{
    WithObsolete target = new()
    {
        ObsoleteProperty = "value1",
        OtherProperty = "value2"
    };
    return Verifier.Verify(target);
}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.cs#L1155-L1174' title='Snippet source file'>snippet source</a> | <a href='#snippet-withobsoleteprop' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

Result:

<!-- snippet: SerializationTests.WithObsoleteProp.verified.txt -->
<a id='snippet-SerializationTests.WithObsoleteProp.verified.txt'></a>
```txt
{
  OtherProperty: value2
}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.WithObsoleteProp.verified.txt#L1-L3' title='Snippet source file'>snippet source</a> | <a href='#snippet-SerializationTests.WithObsoleteProp.verified.txt' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


### Including Obsolete members

Obsolete members can be included using `IncludeObsoletes`:

<!-- snippet: WithObsoletePropIncluded -->
<a id='snippet-withobsoletepropincluded'></a>
```cs
[Fact]
public Task WithObsoletePropIncluded()
{
    WithObsolete target = new()
    {
        ObsoleteProperty = "value1",
        OtherProperty = "value2"
    };
    VerifySettings settings = new();
    settings.ModifySerialization(_ => { _.IncludeObsoletes(); });
    return Verifier.Verify(target, settings);
}

[Fact]
public Task WithObsoletePropIncludedFluent()
{
    WithObsolete target = new()
    {
        ObsoleteProperty = "value1",
        OtherProperty = "value2"
    };
    return Verifier.Verify(target)
        .ModifySerialization(_ => { _.IncludeObsoletes(); });
}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.cs#L1126-L1153' title='Snippet source file'>snippet source</a> | <a href='#snippet-withobsoletepropincluded' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

Result:

<!-- snippet: SerializationTests.WithObsoletePropIncluded.verified.txt -->
<a id='snippet-SerializationTests.WithObsoletePropIncluded.verified.txt'></a>
```txt
{
  ObsoleteProperty: value1,
  OtherProperty: value2
}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.WithObsoletePropIncluded.verified.txt#L1-L4' title='Snippet source file'>snippet source</a> | <a href='#snippet-SerializationTests.WithObsoletePropIncluded.verified.txt' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## Ignore member by expressions

To ignore members of a certain type using an expression:

<!-- snippet: IgnoreMemberByExpression -->
<a id='snippet-ignorememberbyexpression'></a>
```cs
[Fact]
public async Task IgnoreMemberByExpression()
{
    IgnoreExplicitTarget target = new()
    {
        Include = "Value",
        Field = "Value",
        Property = "Value"
    };
    VerifySettings settings = new();
    settings.ModifySerialization(_ =>
    {
        _.IgnoreMember<IgnoreExplicitTarget>(x => x.Property);
        _.IgnoreMember<IgnoreExplicitTarget>(x => x.Field);
        _.IgnoreMember<IgnoreExplicitTarget>(x => x.GetOnlyProperty);
        _.IgnoreMember<IgnoreExplicitTarget>(x => x.PropertyThatThrows);
    });
    await Verifier.Verify(target, settings);
}

[Fact]
public async Task IgnoreMemberByExpressionFluent()
{
    IgnoreExplicitTarget target = new()
    {
        Include = "Value",
        Field = "Value",
        Property = "Value"
    };
    await Verifier.Verify(target)
        .ModifySerialization(_ =>
        {
            _.IgnoreMember<IgnoreExplicitTarget>(x => x.Property);
            _.IgnoreMember<IgnoreExplicitTarget>(x => x.Field);
            _.IgnoreMember<IgnoreExplicitTarget>(x => x.GetOnlyProperty);
            _.IgnoreMember<IgnoreExplicitTarget>(x => x.PropertyThatThrows);
        });
}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.cs#L861-L902' title='Snippet source file'>snippet source</a> | <a href='#snippet-ignorememberbyexpression' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

Result:

<!-- snippet: SerializationTests.IgnoreMemberByExpression.verified.txt -->
<a id='snippet-SerializationTests.IgnoreMemberByExpression.verified.txt'></a>
```txt
{
  Include: Value
}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.IgnoreMemberByExpression.verified.txt#L1-L3' title='Snippet source file'>snippet source</a> | <a href='#snippet-SerializationTests.IgnoreMemberByExpression.verified.txt' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## Ignore member by name

To ignore members of a certain type using type and name:

<!-- snippet: IgnoreMemberByName -->
<a id='snippet-ignorememberbyname'></a>
```cs
[Fact]
public async Task IgnoreMemberByName()
{
    IgnoreExplicitTarget target = new()
    {
        Include = "Value",
        Field = "Value",
        Property = "Value",
        PropertyByName = "Value"
    };
    VerifySettings settings = new();
    settings.ModifySerialization(_ =>
    {
        _.IgnoreMember("PropertyByName");
        var type = typeof(IgnoreExplicitTarget);
        _.IgnoreMember(type, "Property");
        _.IgnoreMember(type, "Field");
        _.IgnoreMember(type, "GetOnlyProperty");
        _.IgnoreMember(type, "PropertyThatThrows");
    });
    await Verifier.Verify(target, settings);
}

[Fact]
public async Task IgnoreMemberByNameFluent()
{
    IgnoreExplicitTarget target = new()
    {
        Include = "Value",
        Field = "Value",
        Property = "Value",
        PropertyByName = "Value"
    };
    await Verifier.Verify(target)
        .ModifySerialization(_ =>
        {
            _.IgnoreMember("PropertyByName");
            var type = typeof(IgnoreExplicitTarget);
            _.IgnoreMember(type, "Property");
            _.IgnoreMember(type, "Field");
            _.IgnoreMember(type, "GetOnlyProperty");
            _.IgnoreMember(type, "PropertyThatThrows");
        });
}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.cs#L951-L998' title='Snippet source file'>snippet source</a> | <a href='#snippet-ignorememberbyname' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

Result:

<!-- snippet: SerializationTests.IgnoreMemberByName.verified.txt -->
<a id='snippet-SerializationTests.IgnoreMemberByName.verified.txt'></a>
```txt
{
  Include: Value
}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.IgnoreMemberByName.verified.txt#L1-L3' title='Snippet source file'>snippet source</a> | <a href='#snippet-SerializationTests.IgnoreMemberByName.verified.txt' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## Members that throw

Members that throw exceptions can be excluded from serialization based on the exception type or properties.

By default members that throw `NotImplementedException` or `NotSupportedException` are ignored.

Note that this is global for all members on all types.

Ignore by exception type:

<!-- snippet: IgnoreMembersThatThrow -->
<a id='snippet-ignoremembersthatthrow'></a>
```cs
[Fact]
public async Task CustomExceptionProp()
{
    WithCustomException target = new();
    VerifySettings settings = new();
    settings.ModifySerialization(_ => _.IgnoreMembersThatThrow<CustomException>());
    await Verifier.Verify(target, settings);
}

[Fact]
public async Task CustomExceptionPropFluent()
{
    WithCustomException target = new();
    await Verifier.Verify(target)
        .ModifySerialization(_ => _.IgnoreMembersThatThrow<CustomException>());
}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.cs#L1026-L1045' title='Snippet source file'>snippet source</a> | <a href='#snippet-ignoremembersthatthrow' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

Result:

<!-- snippet: SerializationTests.CustomExceptionProp.verified.txt -->
<a id='snippet-SerializationTests.CustomExceptionProp.verified.txt'></a>
```txt
{}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.CustomExceptionProp.verified.txt#L1-L1' title='Snippet source file'>snippet source</a> | <a href='#snippet-SerializationTests.CustomExceptionProp.verified.txt' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

Ignore by exception type and expression:

<!-- snippet: IgnoreMembersThatThrowExpression -->
<a id='snippet-ignoremembersthatthrowexpression'></a>
```cs
[Fact]
public async Task ExceptionMessageProp()
{
    WithExceptionIgnoreMessage target = new();

    VerifySettings settings = new();
    settings.ModifySerialization(
        _ => _.IgnoreMembersThatThrow<Exception>(x => x.Message == "Ignore"));
    await Verifier.Verify(target, settings);

}

[Fact]
public async Task ExceptionMessagePropFluent()
{
    WithExceptionIgnoreMessage target = new();

    await Verifier.Verify(target)
        .ModifySerialization(
            _ => _.IgnoreMembersThatThrow<Exception>(x => x.Message == "Ignore"));
}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.cs#L625-L649' title='Snippet source file'>snippet source</a> | <a href='#snippet-ignoremembersthatthrowexpression' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

Result:

<!-- snippet: SerializationTests.ExceptionMessageProp.verified.txt -->
<a id='snippet-SerializationTests.ExceptionMessageProp.verified.txt'></a>
```txt
{}
```
<sup><a href='/src/Verify.Tests/Serialization/SerializationTests.ExceptionMessageProp.verified.txt#L1-L1' title='Snippet source file'>snippet source</a> | <a href='#snippet-SerializationTests.ExceptionMessageProp.verified.txt' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## TreatAsString

Certain types, when passed directly in to Verify, are written directly without going through json serialization.

The default mapping is:

<!-- snippet: typeToStringMapping -->
<a id='snippet-typetostringmapping'></a>
```cs
{typeof(string), (target, _) => (string) target},
{typeof(bool), (target, _) => ((bool) target).ToString()},
{typeof(short), (target, _) => ((short) target).ToString()},
{typeof(ushort), (target, _) => ((ushort) target).ToString()},
{typeof(int), (target, _) => ((int) target).ToString()},
{typeof(uint), (target, _) => ((uint) target).ToString()},
{typeof(long), (target, _) => ((long) target).ToString()},
{typeof(ulong), (target, _) => ((ulong) target).ToString()},
{typeof(decimal), (target, _) => ((decimal) target).ToString(CultureInfo.InvariantCulture)},
#if NET5_0
 //   {typeof(Half), (target, settings) => ((Half) target).ToString(CultureInfo.InvariantCulture)},
#endif
{typeof(float), (target, _) => ((float) target).ToString(CultureInfo.InvariantCulture)},
{typeof(double), (target, _) => ((double) target).ToString(CultureInfo.InvariantCulture)},
{typeof(Guid), (target, _) => ((Guid) target).ToString()},
{
    typeof(DateTime), (target, _) =>
    {
        var dateTime = (DateTime) target;
        return dateTime.ToString("yyyy-MM-ddTHH:mm:ss.FFFFFFFz");
    }
},
{
    typeof(DateTimeOffset), (target, _) =>
    {
        var dateTimeOffset = (DateTimeOffset) target;
        return dateTimeOffset.ToString("yyyy-MM-ddTHH:mm:ss.FFFFFFFz");
    }
},
{
    typeof(XmlNode), (target, settings) =>
    {
        var converted = (XmlNode) target;
        var document = XDocument.Parse(converted.OuterXml);
        return new(document.ToString(), "xml");
    }
},
{
    typeof(XDocument), (target, settings) =>
    {
        var converted = (XDocument) target;
        return new(converted.ToString(), "xml");
    }
}
```
<sup><a href='/src/Verify/Serialization/VerifierSettings.cs#L58-L105' title='Snippet source file'>snippet source</a> | <a href='#snippet-typetostringmapping' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

This bypasses the Guid and DateTime scrubbing mentioned above.

Extra types can be added to this mapping:

<!-- snippet: TreatAsString -->
<a id='snippet-treatasstring'></a>
```cs
VerifierSettings.TreatAsString<ClassWithToString>(
    (target, settings) => target.Property);
```
<sup><a href='/src/Verify.Tests/Snippets/Snippets.cs#L49-L54' title='Snippet source file'>snippet source</a> | <a href='#snippet-treatasstring' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->
