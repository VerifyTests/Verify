<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /docs/mdsource/throws.source.md
To change this file edit the source file and then run MarkdownSnippets.
-->

# Verify a method that throws an Exception

Given a method that throws an Exception

<!-- snippet: MethodThatThrows -->
<a id='snippet-methodthatthrows'></a>
```cs
static void MethodThatThrows() =>
    throw new("The Message");
```
<sup><a href='/src/Verify.Tests/ThrowsTests.cs#L41-L46' title='Snippet source file'>snippet source</a> | <a href='#snippet-methodthatthrows' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

That exception behavior can be verified using `Verify.Throws`:

<!-- snippet: TestMethodThatThrows -->
<a id='snippet-testmethodthatthrows'></a>
```cs
[Fact]
public Task TestMethodThatThrows() =>
    Throws(MethodThatThrows);
```
<sup><a href='/src/Verify.Tests/ThrowsTests.cs#L8-L14' title='Snippet source file'>snippet source</a> | <a href='#snippet-testmethodthatthrows' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

Resulting in the following snapshot file:

<!-- snippet: ThrowsTests.TestMethodThatThrows.verified.txt -->
<a id='snippet-ThrowsTests.TestMethodThatThrows.verified.txt'></a>
```txt
{
  Type: Exception,
  Message: The Message,
  StackTrace: at ThrowsTests.MethodThatThrows()
}
```
<sup><a href='/src/Verify.Tests/ThrowsTests.TestMethodThatThrows.verified.txt#L1-L5' title='Snippet source file'>snippet source</a> | <a href='#snippet-ThrowsTests.TestMethodThatThrows.verified.txt' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## IgnoreStackTrace

Oftent the excetion stack trace can be noisy and fragile to causing false failed tests. To exclude it use 


### Fluent API

<!-- snippet: TestMethodThatThrowsIgnoreStackTraceFluent -->
<a id='snippet-testmethodthatthrowsignorestacktracefluent'></a>
```cs
[Fact]
public Task TestMethodThatThrowsIgnoreStackTraceFluent() =>
    Throws(MethodThatThrows).IgnoreStackTrace();
```
<sup><a href='/src/Verify.Tests/ThrowsTests.cs#L15-L21' title='Snippet source file'>snippet source</a> | <a href='#snippet-testmethodthatthrowsignorestacktracefluent' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


### Settings api

<!-- snippet: TestMethodThatThrowsIgnoreStackTraceSettings -->
<a id='snippet-testmethodthatthrowsignorestacktracesettings'></a>
```cs
[Fact]
public Task TestMethodThatThrowsIgnoreStackTraceSettings()
{
    var settings = new VerifySettings();
    settings.IgnoreStackTrace();
    return Throws(MethodThatThrows, settings);
}
```
<sup><a href='/src/Verify.Tests/ThrowsTests.cs#L22-L32' title='Snippet source file'>snippet source</a> | <a href='#snippet-testmethodthatthrowsignorestacktracesettings' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


### Globally

<!-- snippet: IgnoreStackTraceGlobal -->
<a id='snippet-ignorestacktraceglobal'></a>
```cs
VerifierSettings.IgnoreStackTrace();
```
<sup><a href='/src/Verify.Tests/ThrowsTests.cs#L36-L38' title='Snippet source file'>snippet source</a> | <a href='#snippet-ignorestacktraceglobal' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


### Result

<!-- snippet: ThrowsTests.TestMethodThatThrowsIgnoreStackTraceFluent.verified.txt -->
<a id='snippet-ThrowsTests.TestMethodThatThrowsIgnoreStackTraceFluent.verified.txt'></a>
```txt
{
  Type: Exception,
  Message: The Message
}
```
<sup><a href='/src/Verify.Tests/ThrowsTests.TestMethodThatThrowsIgnoreStackTraceFluent.verified.txt#L1-L4' title='Snippet source file'>snippet source</a> | <a href='#snippet-ThrowsTests.TestMethodThatThrowsIgnoreStackTraceFluent.verified.txt' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


## Async

There are specific named `Throws*` method for methods that return a `Task` or a `ValueTask`.


### Task

<!-- snippet: MethodThatThrowsTask -->
<a id='snippet-methodthatthrowstask'></a>
```cs
static async Task MethodThatThrowsTask()
{
    await Task.Delay(1);
    throw new("The Message");
}
```
<sup><a href='/src/Verify.Tests/ThrowsTests.cs#L57-L65' title='Snippet source file'>snippet source</a> | <a href='#snippet-methodthatthrowstask' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

<!-- snippet: TestMethodThatThrowsTask -->
<a id='snippet-testmethodthatthrowstask'></a>
```cs
[Fact]
public Task TestMethodThatThrowsTask() =>
    ThrowsTask(MethodThatThrowsTask);
```
<sup><a href='/src/Verify.Tests/ThrowsTests.cs#L50-L56' title='Snippet source file'>snippet source</a> | <a href='#snippet-testmethodthatthrowstask' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


### ValueTask

<!-- snippet: MethodThatThrowsValueTask -->
<a id='snippet-methodthatthrowsvaluetask'></a>
```cs
static async ValueTask MethodThatThrowsValueTask()
{
    await Task.Delay(1);
    throw new("The Message");
}
```
<sup><a href='/src/Verify.Tests/ThrowsTests.cs#L74-L82' title='Snippet source file'>snippet source</a> | <a href='#snippet-methodthatthrowsvaluetask' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

<!-- snippet: TestMethodThatThrowsValueTask -->
<a id='snippet-testmethodthatthrowsvaluetask'></a>
```cs
[Fact]
public Task TestMethodThatThrowsValueTask() =>
    ThrowsValueTask(MethodThatThrowsValueTask);
```
<sup><a href='/src/Verify.Tests/ThrowsTests.cs#L66-L72' title='Snippet source file'>snippet source</a> | <a href='#snippet-testmethodthatthrowsvaluetask' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->
