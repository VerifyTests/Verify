image:
- macos
- Visual Studio 2019 Preview


for:
  -
    matrix:
      only:
        - image: Visual Studio 2019 Preview
    install:
      - ps: >-
          Invoke-WebRequest "https://dot.net/v1/dotnet-install.ps1" -OutFile "dotnet-install.ps1"

          powershell -File dotnet-install.ps1 --Version "5.0.100-preview.8.20417.9"

          set PATH=%PATH%;%LOCALAPPDATA%\Microsoft\dotnet

          dotnet --version
  -
    matrix:
      only:
        - image: macos
    install:
      - appveyor DownloadFile https://dot.net/v1/dotnet-install.sh
      - sudo bash dotnet-install.sh --version 5.0.100-preview.8.20417.9
      - dotnet --version
skip_commits:
  message: /docs|Merge pull request.*/
build_script:
- ps: >-
    dotnet build src --configuration Release

    dotnet test src --configuration Release --no-build --no-restore
# begin-snippet: AppVeyorArtifacts
on_failure:
  - ps: Get-ChildItem *.received.* -recurse | % { Push-AppveyorArtifact $_.FullName -FileName $_.Name }
# end-snippet
test: off
artifacts:
- path: nugets\*.nupkg
