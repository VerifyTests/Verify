image:
- macos
- Visual Studio 2019
skip_commits:
  message: /doco|Merge pull request.*/
build_script:
- ps: >-
    dotnet build src --configuration Release

    dotnet test src --configuration Release --no-build --no-restore
on_failure:
- ps: >-
  $receivedFiles = Get-ChildItem .\**\*.received.*

  foreach ($receivedFile in $receivedFiles)
  {
    Push-AppveyorArtifact $receivedFile.FullName -FileName $receivedFile.Name
    $verifiedFile = $receivedFile.FullName.Replace('.received.','.verified.')

    if (Test-Path $verifiedFile -PathType leaf)
    {
      Push-AppveyorArtifact $verifiedFile.FullName -FileName $verifiedFile.Name
    }
  }
test: off
artifacts:
- path: nugets\*.nupkg
